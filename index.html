<!DOCTYPE html>
<html>
<head>
<title>RSS Navigation</title>
<meta charset="UTF-8">
<style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    button { display: block; margin: 8px 0; padding: 10px; font-size: 16px; }
</style>
</head>
<body>

<h2>Drama Browser</h2>
<div id="container">Loading...</div>

<script>
async function loadFeed(url) {
    document.getElementById("container").innerHTML = "Loading...";
    try {
        const response = await fetch("https://api.allorigins.win/raw?url=" + encodeURIComponent(url));
        const text = await response.text();
        const parser = new DOMParser();
        const xml = parser.parseFromString(text, "application/xml");

        const items = xml.getElementsByTagName("item");
        const container = document.getElementById("container");
        container.innerHTML = "";

        if (items.length === 0) {
            container.innerHTML = "<p>No items found.</p>";
            return;
        }

        for (let item of items) {
            const title = item.getElementsByTagName("title")[0].textContent;
            const enclosure = item.getElementsByTagName("enclosure")[0];
            if (!enclosure) continue;
            const link = enclosure.getAttribute("url");

            const button = document.createElement("button");
            button.textContent = title;
            button.onclick = () => handleLink(link);
            container.appendChild(button);
        }

    } catch (err) {
        console.error(err);
        document.getElementById("container").innerHTML = "Error loading feed.";
    }
}

function handleLink(url) {
    if (url.startsWith("http://v.allrss.se")) {
        const cleanURL = url.split("?")[0];
        window.open(cleanURL, "_blank");
    } else {
        loadFeed(url);
    }
}

// Start
loadFeed("https://allrss.se/dramas/");
</script>

</body>
</html>
